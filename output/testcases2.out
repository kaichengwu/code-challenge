

##### Top 1 customer LTV
1.
sfly_dwh.Ingest(input_rec, test_data)
2.
sfly_dwh.TopXSimpleLTVCustomers(2, test_data)

--------------------------
====
==== LTV output
====
====
=====================
TOP 2 customer LTV are:
[['a6f55c7d8f42', 'Batman', 2246.8000000000002], ['b6f55c7d8f42', 'Yoda', 1212.0]]





=====================
====
==== Ingest output
====
=====================
('NEW is not valid. Expect ', ['UPLOAD'])
===========
After Ingestion
[{'last_name': 'Smith', 'event_time': '2017-01-06T12:46:46.384Z', 'verb': 'NEW', 'key': '96f55c7d8f42', 'adr_state': 'AK', 'adr_city': 'Middletown', 'type': 'CUSTOMER'}, {'event_time': '2017-01-06T12:45:52.041Z', 'tags': {'some key': 'some value'}, 'verb': 'NEW', 'key': 'ac05e815502f', 'customer_id': '96f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2017-01-06T12:45:52.041Z', 'tags': [{'some key': 'some value'}], 'verb': 'NEW', 'key': 'ac05e815502f', 'customer_id': '96f55c7d8f42', 'type': 'SITE_VISIT'}, {'camera_make': 'Canon', 'event_time': '2017-01-06T12:47:12.344Z', 'camera_model': 'EOS 80D', 'verb': 'UPLOAD', 'key': 'd8ede43b1d9f', 'customer_id': '96f55c7d8f42', 'type': 'IMAGE'}, {'total_amount': '12.34 USD', 'event_time': '2017-01-06T12:55:55.555Z', 'verb': 'NEW', 'key': '68d84e5d1a43', 'customer_id': '96f55c7d8f42', 'type': 'ORDER'}, {'last_name': 'Batman', 'event_time': '2017-01-06T12:46:46.384Z', 'verb': 'NEW', 'key': 'a6f55c7d8f42', 'adr_state': 'CA', 'adr_city': 'Middletown', 'type': 'CUSTOMER'}, {'last_name': 'Batman', 'event_time': '2017-02-06T12:46:46.384Z', 'verb': 'UPDATE', 'key': 'a6f55c7d8f42', 'adr_state': 'NY', 'adr_city': 'Gotham', 'type': 'CUSTOMER'}, {'last_name': 'Yoda', 'event_time': '2017-03-06T12:46:46.384Z', 'verb': 'NEW', 'key': 'b6f55c7d8f42', 'adr_state': 'NY', 'adr_city': 'Gotham', 'type': 'CUSTOMER'}, {'last_name': 'Skywalker', 'event_time': '2017-04-06T12:46:46.384Z', 'verb': 'NEW', 'key': 'c6f55c7d8f42', 'adr_state': 'NY', 'adr_city': 'Gotham', 'type': 'CUSTOMER'}, {'camera_make': 'Canon', 'event_time': '2017-01-06T12:47:12.344Z', 'camera_model': 'EOS 80D', 'verb': 'UPLOAD', 'key': '18ede43b1d9f', 'customer_id': 'a6f55c7d8f42', 'type': 'IMAGE'}, {'total_amount': '227.34 USD', 'event_time': '2017-01-07T12:55:55.555Z', 'verb': 'NEW', 'key': '91d84e5d1a43', 'customer_id': '96f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '7.34 USD', 'event_time': '2017-11-07T12:55:55.555Z', 'verb': 'NEW', 'key': '93d84e5d1a43', 'customer_id': '96f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '12.25 USD', 'event_time': '2017-12-26T12:55:55.555Z', 'verb': 'NEW', 'key': '94d84e5d1a43', 'customer_id': '96f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '12.34 USD', 'event_time': '2018-01-06T12:55:55.555Z', 'verb': 'NEW', 'key': '28d84e5d1a43', 'customer_id': 'a6f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '212.34 USD', 'event_time': '2018-01-08T12:55:55.555Z', 'verb': 'UPDATE', 'key': '28d84e5d1a43', 'customer_id': 'a6f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '30.30 USD', 'event_time': '2018-01-04T12:55:55.555Z', 'verb': 'NEW', 'key': 'b1d84e5d1a43', 'customer_id': 'b6f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '40.40 USD', 'event_time': '2018-01-09T12:55:55.555Z', 'verb': 'NEW', 'key': 'b2d84e5d1a43', 'customer_id': 'b6f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '50.50 USD', 'event_time': '2018-02-20T12:55:55.555Z', 'verb': 'NEW', 'key': 'b3d84e5d1a43', 'customer_id': 'b6f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '10.34 USD', 'event_time': '2018-05-05T12:55:55.555Z', 'verb': 'NEW', 'key': 'c1d84e5d1a43', 'customer_id': 'c6f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '21.21 USD', 'event_time': '2018-06-05T12:55:55.555Z', 'verb': 'NEW', 'key': 'c2d84e5d1a43', 'customer_id': 'c6f55c7d8f42', 'type': 'ORDER'}, {'total_amount': '31.31 USD', 'event_time': '2018-07-05T12:55:55.555Z', 'verb': 'NEW', 'key': 'c3d84e5d1a43', 'customer_id': 'c6f55c7d8f42', 'type': 'ORDER'}, {'event_time': '2017-11-06T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': '9105e815502f', 'customer_id': 'a6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2017-12-26T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': '9205e815502f', 'customer_id': 'a6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-01-06T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': 'a105e815502f', 'customer_id': 'a6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-01-08T12:45:52.041Z', 'tags': {'some key2': 'some value2'}, 'verb': 'NEW', 'key': 'a205e815502f', 'customer_id': 'a6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-01-06T13:45:52.041Z', 'tags': {'some key2': 'some value2'}, 'verb': 'NEW', 'key': 'a305e815502f', 'customer_id': 'a6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-01-08T18:45:52.041Z', 'tags': {'some key2': 'some value2'}, 'verb': 'NEW', 'key': 'a405e815502f', 'customer_id': 'a6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-01-04T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': 'b105e815502f', 'customer_id': 'b6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-01-09T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': 'b205e815502f', 'customer_id': 'b6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-02-20T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': 'b305e815502f', 'customer_id': 'b6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-05-05T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': 'c105e815502f', 'customer_id': 'c6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-06-05T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': 'c205e815502f', 'customer_id': 'c6f55c7d8f42', 'type': 'SITE_VISIT'}, {'event_time': '2018-07-05T12:45:52.041Z', 'tags': {'some key1': 'some value1'}, 'verb': 'NEW', 'key': 'c305e815502f', 'customer_id': 'c6f55c7d8f42', 'type': 'SITE_VISIT'}]
